{"version":3,"file":"index.es.js","sources":["../node_modules/get-node-dimensions/lib/get-margin.js","../node_modules/get-node-dimensions/lib/get-clone-dimensions.js","../node_modules/get-node-dimensions/lib/get-node-dimensions.js","../src/utils/index.ts","../src/index.tsx"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = getMargin;\nvar toNumber = function toNumber(n) {\n  return parseInt(n) || 0;\n};\n\nfunction getMargin(style) {\n  return {\n    top: style ? toNumber(style.marginTop) : 0,\n    right: style ? toNumber(style.marginRight) : 0,\n    bottom: style ? toNumber(style.marginBottom) : 0,\n    left: style ? toNumber(style.marginLeft) : 0\n  };\n}\n\nmodule.exports = exports[\"default\"];","'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = getCloneDimensions;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _getMargin = require('./get-margin');\n\nvar _getMargin2 = _interopRequireDefault(_getMargin);\n\nfunction getCloneDimensions(node, options) {\n  var parentNode = node.parentNode;\n\n  var context = document.createElement('div');\n  var clone = node.cloneNode(true);\n  var style = getComputedStyle(node);\n  var rect = undefined,\n      width = undefined,\n      height = undefined,\n      margin = undefined;\n\n  // give the node some context to measure off of\n  // no height and hidden overflow hide node copy\n  context.style.height = 0;\n  context.style.overflow = 'hidden';\n\n  // clean up any attributes that might cause a conflict with the original node\n  // i.e. inputs that should focus or submit data\n  clone.setAttribute('id', '');\n  clone.setAttribute('name', '');\n\n  // set props to get a true dimension calculation\n  if (options.display || style && style.getPropertyValue('display') === 'none') {\n    clone.style.display = options.display || 'block';\n  }\n  if (options.width || style && !parseInt(style.getPropertyValue('width'))) {\n    clone.style.width = options.width || 'auto';\n  }\n  if (options.height || style && !parseInt(style.getPropertyValue('height'))) {\n    clone.style.height = options.height || 'auto';\n  }\n\n  // append copy to context\n  context.appendChild(clone);\n\n  // append context to DOM so we can measure\n  parentNode.appendChild(context);\n\n  // get accurate dimensions\n  rect = clone.getBoundingClientRect();\n  width = clone.offsetWidth;\n  height = clone.offsetHeight;\n\n  // destroy clone\n  parentNode.removeChild(context);\n\n  return {\n    rect: {\n      width: width,\n      height: height,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom,\n      left: rect.left\n    },\n    margin: (0, _getMargin2['default'])(style)\n  };\n}\n\nmodule.exports = exports['default'];","'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports['default'] = getNodeDimensions;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _getCloneDimensions = require('./get-clone-dimensions');\n\nvar _getCloneDimensions2 = _interopRequireDefault(_getCloneDimensions);\n\nvar _getMargin = require('./get-margin');\n\nvar _getMargin2 = _interopRequireDefault(_getMargin);\n\nfunction getNodeDimensions(node) {\n  var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  var rect = node.getBoundingClientRect();\n  var width = undefined,\n      height = undefined,\n      margin = undefined;\n\n  // determine if we need to clone the element to get proper dimensions or not\n  if (!rect.width || !rect.height || options.clone) {\n    var cloneDimensions = (0, _getCloneDimensions2['default'])(node, options);\n    rect = cloneDimensions.rect;\n    margin = cloneDimensions.margin;\n  }\n  // if no cloning needed, we need to determine if margin should be accounted for\n  else if (options.margin) {\n      margin = (0, _getMargin2['default'])(getComputedStyle(node));\n    }\n\n  // include margin in width/height calculation if desired\n  if (options.margin) {\n    width = margin.left + rect.width + margin.right;\n    height = margin.top + rect.height + margin.bottom;\n  } else {\n    width = rect.width;\n    height = rect.height;\n  }\n\n  return {\n    width: width,\n    height: height,\n    top: rect.top,\n    right: rect.right,\n    bottom: rect.bottom,\n    left: rect.left\n  };\n}\n\nmodule.exports = exports['default'];","/**\r\n * @description Is null\r\n * @param val\r\n */\r\nexport const isNull = (val: any): boolean => val === null;\r\n\r\n/**\r\n * @description Is object\r\n * @param val\r\n */\r\nexport const isObj = (val: any): boolean => typeof val === 'object' && !isNull(val) && !Array.isArray(val);\r\n\r\n/**\r\n * @description Is function\r\n * @param val\r\n */\r\nexport const isFunc = (val: any): boolean => typeof val === 'function';\r\n\r\n/**\r\n * @description Uid\r\n * @param len\r\n */\r\nexport const uid = (len: number = 7) => Math.random().toString(35).substr(2, len);\r\n\r\n/**\r\n * @description Debounce\r\n * @param id\r\n * @param delay\r\n */\r\nexport const debounce = (id: number | string, delay: number | 300 | undefined): (callback: () => void) => void => {\r\n  const timers = {};\r\n\r\n  return (callback) => {\r\n    if (timers[id]) {\r\n      clearTimeout(timers[id]);\r\n    }\r\n\r\n    timers[id] = setTimeout(callback, delay);\r\n  };\r\n};\r\n\r\nexport interface ScrollSpyInitConfig {\r\n  element: any,\r\n  immediate?: boolean | false,\r\n  onScroll: (scrollYOffset: number) => void\r\n}\r\n\r\n\r\n/**\r\n * @description Scroll spy\r\n */\r\nexport const scrollSpy = () => {\r\n  let targetElement = window;\r\n  let didScroll = false;\r\n  let hasElement = false;\r\n  const onScrollDelay = 50;\r\n  // @ts-ignore\r\n  // eslint-disable-next-line no-unused-vars\r\n  const defaultOnScroll = (scrollYOffset: number) => {};\r\n  let handleOnScroll = defaultOnScroll;\r\n\r\n  const getDocumentOffsetY = () => window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n  const getOffsetY = () => (hasElement\r\n    // @ts-ignore\r\n    ? targetElement.scrollTop\r\n    : getDocumentOffsetY());\r\n\r\n  const handleScroll = () => {\r\n    const scrollYOffset = getOffsetY();\r\n    handleOnScroll(scrollYOffset);\r\n    didScroll = false;\r\n  };\r\n\r\n  const scrollListener = () => {\r\n    if (!didScroll) {\r\n      setTimeout(handleScroll, onScrollDelay);\r\n      didScroll = true;\r\n    }\r\n  };\r\n\r\n  const attachListener = () => {\r\n    targetElement.addEventListener('scroll', scrollListener);\r\n  };\r\n\r\n  const detachListener = () => {\r\n    targetElement.removeEventListener('scroll', scrollListener);\r\n  };\r\n\r\n  return {\r\n    init(initData: ScrollSpyInitConfig) {\r\n      const { element, immediate = false, onScroll } = initData;\r\n      handleOnScroll = onScroll;\r\n      hasElement = isObj(element);\r\n\r\n      if (hasElement) {\r\n        targetElement = element;\r\n      }\r\n\r\n      if (immediate) {\r\n        handleScroll();\r\n      }\r\n\r\n      attachListener();\r\n      return this;\r\n    },\r\n    destroy() {\r\n      detachListener();\r\n      handleOnScroll = defaultOnScroll;\r\n      return this;\r\n    }\r\n  };\r\n};\r\n","import * as React from 'react';\r\nimport getNodeDimensions from 'get-node-dimensions';\r\nimport { uid, debounce, scrollSpy, isObj, isFunc, ScrollSpyInitConfig } from './utils';\r\n\r\nconst { useEffect } = React;\r\n\r\nexport type InfiScrollerProps = {\r\n  children: JSX.Element | null,\r\n  scrollTarget?: JSX.Element | null,\r\n  debounceDelay?: number,\r\n  gutter?: number,\r\n  immediate?: boolean,\r\n  active?: boolean,\r\n  hasMore?: boolean,\r\n  shouldLoadMore?: (targetHeight: number, scrollYOffset: number, gutter: number, scrollHeight: number) => boolean,\r\n  onLoadMore: () => void\r\n}\r\n\r\nconst InfiScroller = (props: InfiScrollerProps): JSX.Element | null => {\r\n  const { children, scrollTarget, debounceDelay, gutter, immediate, active, hasMore, shouldLoadMore, onLoadMore } = props;\r\n  const hasScrollTarget = isObj(scrollTarget);\r\n\r\n  const handleOnScroll = (scrollYOffset: number) => {\r\n    const targetHeight = hasScrollTarget\r\n      // @ts-ignore\r\n      ? getNodeDimensions(scrollTarget).height\r\n      : window.innerHeight;\r\n\r\n    const scrollHeight = hasScrollTarget\r\n      // @ts-ignore\r\n      ? scrollTarget.scrollHeight\r\n      : document.body.clientHeight;\r\n\r\n    // @ts-ignore\r\n    if (hasMore && shouldLoadMore(targetHeight, scrollYOffset, gutter, scrollHeight)) {\r\n      onLoadMore();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    let debouncer: any = null;\r\n    let scroller: any = null;\r\n\r\n    if (active) {\r\n      debouncer = debounce(uid(), debounceDelay);\r\n\r\n      const initConfig: ScrollSpyInitConfig = {\r\n        element: scrollTarget,\r\n        immediate,\r\n        onScroll: (scrollYOffset: number) => {\r\n          const handleOnScrollCallback = () => handleOnScroll(scrollYOffset);\r\n\r\n          if (!isFunc(debouncer)) {\r\n            handleOnScrollCallback();\r\n          } else {\r\n            debouncer(handleOnScrollCallback);\r\n          }\r\n        }\r\n      };\r\n\r\n      scroller = scrollSpy().init(initConfig);\r\n    }\r\n\r\n    return () => {\r\n      if (isFunc(debouncer)) {\r\n        debouncer = null;\r\n        scroller.destroy();\r\n        scroller = null;\r\n      }\r\n    };\r\n  }, [children, active]);\r\n\r\n  return children;\r\n};\r\n\r\nInfiScroller.defaultProps = {\r\n  scrollTarget: null,\r\n  debounceDelay: 300,\r\n  gutter: 10,\r\n  immediate: false,\r\n  active: true,\r\n  hasMore: false,\r\n  shouldLoadMore: (targetHeight: number, scrollYOffset: number, gutter: number, scrollHeight: number) => (\r\n    targetHeight + scrollYOffset + gutter >= scrollHeight\r\n  )\r\n};\r\n\r\nexport default InfiScroller;\r\n"],"names":["Object","defineProperty","exports","value","style","top","toNumber","marginTop","right","marginRight","bottom","marginBottom","left","marginLeft","n","parseInt","module","node","options","rect","width","height","parentNode","context","document","createElement","clone","cloneNode","getComputedStyle","overflow","setAttribute","display","getPropertyValue","appendChild","getBoundingClientRect","offsetWidth","offsetHeight","removeChild","margin","_getMargin2","obj","_getMargin","__esModule","default","_interopRequireDefault","arguments","length","undefined","cloneDimensions","_getCloneDimensions2","_getCloneDimensions","isObj","val","isNull","Array","isArray","isFunc","scrollSpy","targetElement","window","didScroll","hasElement","defaultOnScroll","scrollYOffset","handleOnScroll","getOffsetY","scrollTop","pageYOffset","documentElement","handleScroll","scrollListener","setTimeout","init","initData","element","_a","immediate","onScroll","addEventListener","this","destroy","removeEventListener","useEffect","InfiScroller","props","children","scrollTarget","debounceDelay","gutter","active","hasMore","shouldLoadMore","onLoadMore","hasScrollTarget","id","delay","timers","len","debouncer","scroller","Math","random","toString","substr","callback","clearTimeout","initConfig","handleOnScrollCallback","targetHeight","getNodeDimensions","innerHeight","scrollHeight","body","clientHeight","defaultProps"],"mappings":"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"}